# 简介

- MySQL 是一个关系型数据库管理系统，由瑞典 MySQL AB公司开发，目前属于 Oracle 公司
- MySQL 是一种关联数据库管理系统，将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性
- MySQL 是可以定制的，采用了 GPL 协议，你可以修改源码来开发自己的 Mysql 系统
- MySQL 支持大型的数据库。可以处理拥有上千万条记录的大型数据库
- MySQL 使用标准的 SQL 数据语言形式
- MySQL 可以允许于多个系统上，并且支持多种语言。这些编程语言包括 C、C++、Python、Java、Perl、PHP、Eiffel、Ruby 和 Tcl 等
- MySQL 支持大型数据库，支持 5000 万条记录的数据仓库，32 位系统表文件最大可支持 4GB，64 位系统支持最大的表文件为 8TB

# 安装

**下载地址**

```http
http://dev.mysql.com/downloads/mysql/
```

**预检查是否安装过 MySQL**

```shell
rpm -qa|grep mysql
```

**卸载老版本 MySQL** 

```shell
rpm -e --nodeps  mysql-libs
```

**提升 `/tmp`文件夹权限**

```shell
# 由于mysql安装过程中，会通过mysql用户在/tmp目录下新建tmp_db文件，所以请给/tmp较大的权限
chmod -R 777 /tmp
```

**安装**

```shell
#在mysql的安装文件目录下执行
rpm -ivh MySQL-server-5.5.54-1.linux2.6.x86_64.rpm
rpm -ivh MySQL-client-5.5.54-1.linux2.6.x86_64.rpm
```

**查看安装版本**

```shell
mysqladmin --version
```

**MySQL 启动**

```shell
service mysql start
```

**MySQL 停止**

```shell
service mysql stop
```

**设置自启动**

```shell
chkconfig --level 2345 mysql on
```

**首次登陆修改密码**

```shell
/usr/bin/mysqladmin -u root password '123456'
```

**MySQL 安装目录**

```shell
ps -ef|grep mysql
```

| 参数         | 路径                            | 解释                         | 备注                       |
| ------------ | ------------------------------- | ---------------------------- | -------------------------- |
| --basedir    | /usr/bin                        | 相关命令目录                 | mysqladmin mysqldump等命令 |
| --datadir    | /var/lib/mysql/                 | mysql数据库文件的存放路径    |                            |
| --plugin-dir | /usr/lib64/mysql/plugin         | mysql插件存放路径            |                            |
| --log-error  | /var/lib/mysql/jack.atguigu.err | mysql错误日志路径            |                            |
| --pid-file   | /var/lib/mysql/jack.atguigu.pid | 进程pid文件                  |                            |
| --socket     | /var/lib/mysql/mysql.sock       | 本地连接时用的unix套接字文件 |                            |
|              | /usr/share/mysql                | 配置文件目录                 | mysql脚本及配置文件        |
|              | /etc/init.d/mysql               | 服务启停相关脚本             |                            |

**调整字符集**

```mysql
# 查看字符集
SHOW VARIABLES LIKE 'character%';
```

**修改my.cnf**

在 /usr/share/mysql/ 中找到 my.cnf 的配置文件，拷贝其中的my-huge.cnf 到 /etc/  并命名为 my.cnf

```shell
[client]
default-character-set=utf8mb4
[mysqld]
character_set_server=utf8mb4
character_set_client=utf8mb4
collation-server=utf8_general_ci
[mysql]
default-character-set=utf8mb4
```

**修改数据库的字符集**

```mysql
ALTER DATABASE 库名 CHARACTER SET 'utf8';
```

**修改数据表的字符集**

```mysql
ALTER TABLE 表名 CONVERT TO CHARACTER SET 'utf8';
```

# 配置文件

## 二进制日志 log-bin

- 主要用作主从复制和备份恢复

## 错误日志 log-error

- 默认是关闭的,记录严重的警告和错误信息，每次启动和关闭的详细信息等

## 慢查询日志 log

- 默认关闭，记录查询的sql语句，如果开启会减低mysql的整体性能，因为记录日志也是需要消耗系统资源的
- 可自定义“慢”的概念：0-10秒之间的一个数，慢查询日志会将超过这个查询事件的查询记录下来，方便找到需要优化的 sql 

## 数据文件

### MyISAM 存放方式

| 文件类型           | 作用       |
| ------------------ | ---------- |
| frm文件(framework) | 存放表结构 |
| myd文件(data)      | 存放表数据 |
| myi文件(index)     | 存放表索引 |

### InnoDB 存放方式

| 文件类型       | 作用                                                         |
| -------------- | ------------------------------------------------------------ |
| ibdata1        | Innodb引擎将所有表的的数据都存在这里面 `/usr/share/mysql/ibdata1`，而frm文件存放在库同名的包下 |
| frm文件        | 存放表结构                                                   |
| myi文件(index) | set innodb_file_per_table=on，设在为 on 后 单独以 table名.ibd 的文件名存储 |

# 用户管理

## 创建用户

```mysql
CREATE USER zhang3 IDENTIFIED BY '密码';
```

## 查看用户

```mysql
select host,user,password,select_priv,insert_priv,drop_priv from mysql.user;
```

### host 连接类型

- % 表示所有远程通过 TCP方式的连接
- IP 地址如 (192.168.1.2,127.0.0.1) 通过指定 IP 地址进行的 TCP 方式的连接
- 机器名，通过制定i网络中的机器名进行的TCP方式的连接
- `::1`，IPv6的本地ip地址，等同于IPv4的 127.0.0.1
- localhost，本地方式通过命令行方式的连接 ，比如 `mysql -u xxx -p 123xxx` 方式的连接。

### user 用户名

- 同一用户通过不同方式链接的权限是不一样的

### password 密码

- 所有密码串通过 password (明文字符串) 生成的密文字符串。加密算法为 MYSQLSHA1 ，不可逆 
- mysql 5.7 的密码保存到 authentication_string 字段中，不再使用 password 字段。

#### 修改当前用户密码

```mysql
SET PASSWORD = PASSWORD ( '123456' )
```

#### 修改某个用户的密码

```mysql
UPDATE mysql.USER 
SET PASSWORD = PASSWORD ( '123456' ) 
WHERE
	USER = 'zhouju';
```

### 修改用户名

```mysql
UPDATE mysql.USER 
SET USER = 'li4' 
WHERE
	USER = 'wang5';
```

> 注意：所有通过 user 表的修改，必须 使用 `flush privileges `命令才能生效

### 删除用户

```mysql
DROP USER 用户名;
```

> 不要通过 DELETE FROM USER u WHERE USER = '用户名' 进行删除，系统会有残留信息保留

# 权限管理

## 授予权限



